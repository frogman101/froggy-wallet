<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Froggy BSV Wallet</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-900 text-white p-5">

    <!-- Sidebar Navigation -->
    <div class="fixed left-0 top-0 h-full w-64 bg-gray-800 shadow-lg">
        <h2 class="text-2xl font-bold text-center mt-5">🐸 Froggy Wallet</h2>
        <ul class="mt-6">
            <li class="p-4 hover:bg-gray-700"><a href="/">🏠 Home</a></li>
            <li class="p-4 hover:bg-gray-700"><a href="#">📄 Transactions</a></li>
            <li class="p-4 hover:bg-gray-700"><a href="#">⚙️ Settings</a></li>
        </ul>
    </div>

    <!-- Main Content -->
    <div class="ml-64 p-6">
        <h1 class="text-3xl font-bold text-center mb-4">Your Bitcoin SV Wallet</h1>

        <!-- Wallet Info -->
        <div class="bg-gray-800 p-6 rounded-lg shadow-md">
            <h3 class="text-lg font-semibold">💰 Balance:</h3>
            <p id="balance" class="text-2xl font-bold mt-2">$0.00</p>

            <button id="generate-wallet" class="mt-4 bg-green-500 hover:bg-green-600 text-white px-6 py-3 rounded-lg w-full transition">
                🚀 Create New Wallet
            </button>
            <button id="restore-wallet" class="mt-2 bg-blue-500 hover:bg-blue-600 text-white px-6 py-3 rounded-lg w-full transition">
                🔄 Restore Wallet
            </button>
        </div>

        <!-- Seed Phrase -->
        <div id="wallet-info" class="mt-4 hidden bg-gray-800 p-6 rounded-lg shadow-md">
            <h3 class="text-lg font-semibold">🔑 Seed Phrase</h3>
            <p id="mnemonic" class="text-sm font-mono p-2 bg-gray-700 rounded"></p>
            <button onclick="copyText('mnemonic')" class="mt-2 bg-blue-400 hover:bg-blue-500 text-white px-3 py-1 rounded">
                📋 Copy
            </button>
        </div>

        <!-- Wallet Addresses -->
        <h3 class="mt-6 text-xl">📍 Your Addresses</h3>
        <ul id="address-list" class="mt-2 bg-gray-800 p-4 rounded-lg"></ul>
        <button id="generate-address" class="mt-4 bg-yellow-500 hover:bg-yellow-600 text-white px-6 py-3 rounded-lg w-full hidden">
            ➕ Generate New Address
        </button>

        <!-- Send BSV -->
        <h3 class="mt-6 text-xl">💸 Send BSV</h3>
        <input id="recipient" type="text" placeholder="Recipient Address" class="p-2 border rounded w-full mt-2 text-black">
        <input id="amount" type="number" placeholder="Amount in BSV" class="p-2 border rounded w-full mt-2 text-black">
        <button id="send-bsv" class="mt-4 bg-red-500 hover:bg-red-600 text-white px-6 py-3 rounded-lg w-full">
            🚀 Send
        </button>

        <!-- Transaction History -->
        <h3 class="mt-6 text-xl">📜 Transaction History</h3>
        <ul id="transaction-history" class="mt-2 bg-gray-800 p-4 rounded-lg"></ul>

    </div>

    <script>
        function copyText(elementId) {
            const text = document.getElementById(elementId).innerText;
            navigator.clipboard.writeText(text);
            alert("Copied: " + text);
        }

        document.getElementById("generate-wallet").addEventListener("click", async () => {
            const response = await fetch("/generate-wallet", { 
                method: "POST", 
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ userId: "default-user" }) 
            });
            const data = await response.json();
            document.getElementById("mnemonic").innerText = data.mnemonic;
            document.getElementById("wallet-info").classList.remove("hidden");
            document.getElementById("generate-address").classList.remove("hidden");
            alert("Wallet Created!");
        });

        document.getElementById("restore-wallet").addEventListener("click", async () => {
            const mnemonic = prompt("Enter your 12-word seed phrase:");
            const response = await fetch("/restore-wallet", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ userId: "default-user", mnemonic })
            });
            const data = await response.json();
            if (data.restoredAddress) {
                alert("Wallet Restored!");
            } else {
                alert("Invalid Seed Phrase!");
            }
        });

        document.getElementById("generate-address").addEventListener("click", async () => {
            const response = await fetch("/generate-new-address", { 
                method: "POST", 
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ userId: "default-user" }) 
            });
            const data = await response.json();
            document.getElementById("address-list").innerHTML += `<li>${data.newAddress}</li>`;
        });

        document.getElementById("send-bsv").addEventListener("click", async () => {
            const recipientAddress = document.getElementById("recipient").value;
            const amount = document.getElementById("amount").value;
            if (!recipientAddress || !amount) {
                alert("Please enter a valid address and amount.");
                return;
            }
            const response = await fetch("/send-bsv", { 
                method: "POST", 
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ userId: "default-user", recipientAddress, amount }) 
            });
            const data = await response.json();
            if (data.success) {
                alert("Transaction Sent! TXID: " + data.txid);
            } else {
                alert("Error: " + data.error);
            }
        });

        async function fetchBalance() {
            const response = await fetch("/get-balance", { 
                method: "POST", 
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ address: "your-bsv-address" }) 
            });

            const data = await response.json();
            document.getElementById("balance").innerText = `${data.balanceInBSV} BSV ($${data.balanceInUSD})`;
        }

        setInterval(fetchBalance, 10000);
  <!-- Top Navigation Bar -->
<div class="fixed top-0 right-0 p-4">
    <span id="user-info" class="text-lg"></span>
    <button id="login-btn" class="bg-blue-500 text-white px-4 py-2 rounded">Login</button>
    <button id="logout-btn" class="hidden bg-red-500 text-white px-4 py-2 rounded">Logout</button>
</div>

<script>
    async function checkSession() {
        const response = await fetch('/session');
        const data = await response.json();
        if (data.loggedIn) {
            document.getElementById("user-info").innerText = `👤 ${data.user}`;
            document.getElementById("login-btn").classList.add("hidden");
            document.getElementById("logout-btn").classList.remove("hidden");
        }
    }

    document.getElementById("login-btn").addEventListener("click", async () => {
        const username = prompt("Enter your username:");
        const password = prompt("Enter your password:");
        const response = await fetch('/login', {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ username, password })
        });
        const data = await response.json();
        if (data.success) {
            alert("Login successful!");
            location.reload();
        } else {
            alert("Error: " + data.error);
        }
    });

    document.getElementById("logout-btn").addEventListener("click", async () => {
        await fetch('/logout');
        alert("Logged out!");
        location.reload();
    });

    checkSession();

  </script>
</body>
</html>
